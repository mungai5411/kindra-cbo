{% extends "reporting/base_report.html" %}

{% block title %}Donation Report - {{ report.title }}{% endblock %}

{% block content %}
<!-- Header -->
<div class="report-header">
    <div class="logo-section">
        {% if logo_path %}
        <img src="file://{{ logo_path }}" class="logo-img">
        {% else %}
        <div
            style="border:1px solid #ccc; width:60px; height:60px; line-height:60px; text-align:center; font-size:10px;">
            LOGO</div>
        {% endif %}
    </div>
    <div class="org-info">
        <h1 class="org-name">Kindra CBO</h1>
        <p class="org-details">Community-Based Organization | Nairobi, Kenya</p>
        <p class="org-details">info@kindra.org | +254 XXX XXX XXX</p>
    </div>
    <div class="report-badge">Donation Report</div>
</div>

<!-- Report Metadata -->
<div class="report-meta">
    <h2 class="report-title">{{ report.title }}</h2>
    <div class="meta-row">
        <span class="meta-label">Report Period:</span>
        <span class="meta-value">{{ report.start_date|date:"d M Y" }} - {{ report.end_date|date:"d M Y" }}</span>
    </div>
    <div class="meta-row">
        <span class="meta-label">Generated On:</span>
        <span class="meta-value">{{ report.generated_at|date:"d M Y H:i" }}</span>
    </div>
    <div class="meta-row">
        <span class="meta-label">Generated By:</span>
        <span class="meta-value">{{ report.generated_by.get_full_name|default:"System Admin" }}</span>
    </div>
</div>

<!-- Summary Statistics -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-value">{{ summary.total_donations }}</div>
        <div class="stat-label">Total Donations</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">KES {{ summary.total_amount|floatformat:2 }}</div>
        <div class="stat-label">Total Amount</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ summary.donors_count }}</div>
        <div class="stat-label">Unique Donors</div>
    </div>
</div>

<!-- Data Table -->
<table class="data-table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Donor</th>
            <th>Amount</th>
            <th>Method</th>
            <th>Campaign</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% for donation in donations %}
        <tr>
            <td>{{ donation.donation_date|date:"d M Y H:i"|default:"-" }}</td>
            <td>{{ donation.donor_name|default:donation.donor.full_name|default:"Anonymous" }}</td>
            <td style="font-weight: bold;">{{ donation.currency|default:"KES" }} {{ donation.amount|floatformat:2 }}
            </td>
            <td>{{ donation.payment_method|default:"-" }}</td>
            <td>{{ donation.campaign.title|default:"General Fund" }}</td>
            <td>
                <span
                    style="{% if donation.status == 'COMPLETED' %}color: #519755; font-weight: bold;{% elif donation.status == 'PENDING' %}color: #FFA500;{% else %}color: #999;{% endif %}">
                    {{ donation.status }}
                </span>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6" style="text-align: center; color: #999; padding: 20px;">
                No donation records found for this period.
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Signature Section -->
<div class="signature-section">
    <div class="signature-line"></div>
    <div class="signature-text">Authorized Signature</div>
</div>

<!-- Footer -->
<div class="report-footer">
    <p>Kindra Community-Based Organization | {{ report.generated_at|date:"Y" }}</p>
    <p>This is a computer-generated report and requires no signature</p>
</div>
{% endblock %}